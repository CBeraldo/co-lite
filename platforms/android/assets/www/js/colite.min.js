!function(){"use strict";function e(){var e=this;return e.connect=function(){var e={name:"database.db",location:"default",bgType:1};return $cordovaSQLite.openDB(e)},e.execute=function(t,r){return $cordovaSQLite.execute(e.connect(),t,r)},e.deviceready=function(e){document.addEventListener("deviceready",function(){e()},!1)},e.orm={drop:function(){var t=["DROP TABLE IF EXISTS",this.displayName].join("  ");return e.execute(t)},create:function(){var t=this,r=[];Object.keys(t.prototype).forEach(function(e,n){var o="",i=t.base[e];o=[o,e,i.type].join(" "),o=i.allowNulls?[o,"NULL"].join(" "):[o,"NOT NULL"].join(" "),i.primaryKey?o=[o,"PRIMARY KEY AUTOINCREMENT"].join(" "):i.uniqueKey&&(o=[o,"UNIQUE"].join(" ")),r.push(o)});var n=["CREATE TABLE IF NOT EXISTS",this.displayName,"(",r.join(", "),")"].join("  ");return e.execute(n)},insert:function(t){var r=this,n=[],o=[];Object.keys(r.prototype).forEach(function(e,r){"id"!=e&&(n.push(e),o.push(t[e]))});var i=" insert into {0} ( {1} ) values ( ? {2} ) ".format(r.displayName,n.join(", "),", ?".repeat(o.length-1));return e.execute(i,o)},update:function(t){var r=this,n=[],o=[];Object.keys(r.prototype).forEach(function(e,r){"id"!=e&&(n.push(e+" = ?"),o.push(t[e]))}),o.push(t.id);var i=" update {0} set {1} where id = ? ".format(r.displayName,n.join(", "));return e.execute(i,o)},delete:function(t){var r=this,n=" delete from {0} where id = ? ".format(r.displayName);return e.execute(n,[t])},select:function(t){var r=" select * from {0} ".format([this.displayName]);return t?(r+=" where id = ? ",e.execute(r,[t])):e.execute(r)}},e.implement=function(t,r,n){function o(){}return Object.keys(r).forEach(function(e){o.prototype[e]=null}),o.prototype.id=null,o.displayName=t,o.base=r,o.drop=e.orm.drop,o.create=e.orm.create,o.insert=e.orm.insert,o.update=e.orm.update,o.delete=e.orm.delete,o.select=e.orm.select,e.deviceready(function(){n&&o.drop(),o.create()}),o},{deviceready:e.deviceready,implement:e.implement}}String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t})}),String.prototype.repeat||(String.prototype.repeat=function(e){for(var t="",r=this,n=0;n<e;n++)t+=r;return t});angular.module("Colite",["ngCordova"]).service("$colite",e).constant("Colite",{STRING:"STRING",INTEGER:"INTEGER",DATE:"DATE",DATETIME:"DATETIME",BIGINT:"BIGINT",DECIMAL:"NUMERIC",TEXT:"TEXT"});e.$inject=["$cordovaSQLite"]}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGl0ZS5qcyJdLCJuYW1lcyI6WyJDb2xpdGUiLCJ2bSIsInRoaXMiLCJjb25uZWN0IiwiY29uZmlnIiwibmFtZSIsImxvY2F0aW9uIiwiYmdUeXBlIiwiJGNvcmRvdmFTUUxpdGUiLCJvcGVuREIiLCJleGVjdXRlIiwicXVlcnkiLCJ2YWx1ZXMiLCJkZXZpY2VyZWFkeSIsImNhbGxiYWNrIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwib3JtIiwiZHJvcCIsImRpc3BsYXlOYW1lIiwiam9pbiIsImNyZWF0ZSIsIm1vZGVsIiwiT2JqZWN0Iiwia2V5cyIsInByb3RvdHlwZSIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSIsInByb3AiLCJwcm9wT2JqIiwiYmFzZSIsInR5cGUiLCJhbGxvd051bGxzIiwicHJpbWFyeUtleSIsInVuaXF1ZUtleSIsInB1c2giLCJpbnNlcnQiLCJvYmplY3QiLCJmb3JtYXQiLCJyZXBlYXQiLCJsZW5ndGgiLCJ1cGRhdGUiLCJpZCIsImRlbGV0ZSIsInNlbGVjdCIsImltcGxlbWVudCIsImZvcmNlIiwiU3RyaW5nIiwiYXJncyIsImFyZ3VtZW50cyIsInJlcGxhY2UiLCJtYXRjaCIsIm51bWJlciIsInN0ciIsImkiLCJhbmd1bGFyIiwibW9kdWxlIiwic2VydmljZSIsImNvbnN0YW50IiwiU1RSSU5HIiwiSU5URUdFUiIsIkRBVEUiLCJEQVRFVElNRSIsIkJJR0lOVCIsIkRFQ0lNQUwiLCJURVhUIiwiJGluamVjdCJdLCJtYXBwaW5ncyI6IkNBQUMsV0FDRyxZQTBDQSxTQUFTQSxLQUNMLEdBQUlDLEdBQUtDLElBZ0lULE9BOUhBRCxHQUFHRSxRQUFVLFdBQ1QsR0FBSUMsSUFBV0MsS0FBTSxjQUFlQyxTQUFVLFVBQVdDLE9BQVEsRUFDakUsT0FBT0MsZ0JBQWVDLE9BQU9MLElBR2pDSCxFQUFHUyxRQUFVLFNBQVNDLEVBQU9DLEdBQ3pCLE1BQU9KLGdCQUFlRSxRQUFRVCxFQUFHRSxVQUFXUSxFQUFPQyxJQUd2RFgs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LFdBR0hDLElBSVBULFlBQWFaLEVBQUdZLFlBQ2hCaUMsVUFBVzdDLEVBQUc2QyxXQTNLakJFLE9BQU92QixVQUFVYyxTQUNsQlMsT0FBT3ZCLFVBQVVjLE9BQVMsV0FDdEIsR0FBSVUsR0FBT0MsU0FDWCxPQUFPaEQsTUFBS2lELFFBQVEsV0FBWSxTQUFTQyxFQUFPQyxHQUM1QyxXQUE4QixLQUFoQkosRUFBS0ksR0FDZkosRUFBS0ksR0FDTEQsTUFJWEosT0FBT3ZCLFVBQVVlLFNBQ2xCUSxPQUFPdkIsVUFBVWUsT0FBUyxTQUFTQyxHQUkvQixJQUFLLEdBSERhLEdBQU0sR0FDTmQsRUFBU3RDLEtBRUpxRCxFQUFJLEVBQUdBLEVBQUlkLEVBQVFjLElBQ3hCRCxHQUFZZCxDQUdoQixPQUFPYyxJQUlGRSxTQUNSQyxPQUFPLFVBQVcsY0FFbEJDLFFBQVEsVUFBVzFELEdBRW5CMkQsU0FBUyxVQUNOQyxPQUFRLFNBQ1JDLFFBQVMsVUFDVEMsS0FBTSxPQUNOQyxTQUFVLFdBQ1ZDLE9BQVEsU0FDUkMsUUFBUyxVQUNUQyxLQUFNLFFBR2RsRSxHQUFPbUUsU0FBVyIsImZpbGUiOiJjb2xpdGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnXHJcblxyXG4gICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLmZvcm1hdCkge1xyXG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC97KFxcZCspfS9nLCBmdW5jdGlvbihtYXRjaCwgbnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3NbbnVtYmVyXSAhPSAndW5kZWZpbmVkJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tudW1iZXJdIDpcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGlmICghU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQpIHtcclxuICAgICAgICBTdHJpbmcucHJvdG90eXBlLnJlcGVhdCA9IGZ1bmN0aW9uKGxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIHZhciByZXBlYXQgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gc3RyICsgcmVwZWF0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNvbGl0ZSA9IGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdDb2xpdGUnLCBbJ25nQ29yZG92YSddKVxyXG4gICAgICAgIC8vIHNlcnZpw6dvcyBcclxuICAgICAgICAuc2VydmljZSgnJGNvbGl0ZScsIENvbGl0ZSlcclxuICAgICAgICAvLyBjb25zdGFudGVzIFxyXG4gICAgICAgIC5jb25zdGFudCgnQ29saXRlJywge1xyXG4gICAgICAgICAgICBTVFJJTkc6IFwiU1RSSU5HXCIsXHJcbiAgICAgICAgICAgIElOVEVHRVI6IFwiSU5URUdFUlwiLFxyXG4gICAgICAgICAgICBEQVRFOiBcIkRBVEVcIixcclxuICAgICAgICAgICAgREFURVRJTUU6IFwiREFURVRJTUVcIixcclxuICAgICAgICAgICAgQklHSU5UOiBcIkJJR0lOVFwiLFxyXG4gICAgICAgICAgICBERUNJTUFMOiBcIk5VTUVSSUNcIixcclxuICAgICAgICAgICAgVEVYVDogXCJURVhUXCJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBDb2xpdGUuJGluamVjdCA9IFsnJGNvcmRvdmFTUUxpdGUnXTtcclxuXHJcbiAgICBmdW5jdGlvbiBDb2xpdGUoKSB7XHJcbiAgICAgICAgdmFyIHZtID0gdGhpcztcclxuXHJcbiAgICAgICAgdm0uY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY29uZmlnID0geyBuYW1lOiAnZGF0YWJhc2UuZGInLCBsb2NhdGlvbjogJ2RlZmF1bHQnLCBiZ1R5cGU6IDEgfTtcclxuICAgICAgICAgICAgcmV0dXJuICRjb3Jkb3ZhU1FMaXRlLm9wZW5EQihjb25maWcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdm0uZXhlY3V0ZSA9IGZ1bmN0aW9uKHF1ZXJ5LCB2YWx1ZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRjb3Jkb3ZhU1FMaXRlLmV4ZWN1dGUodm0uY29ubmVjdCgpLCBxdWVyeSwgdmFsdWVzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZtLmRldmljZXJlYWR5ID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZGV2aWNlcmVhZHknLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0sIGZhbHNlKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5vcm0gPSB7XHJcbiAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gWydEUk9QIFRBQkxFIElGIEVYSVNUUycsIHRoaXMuZGlzcGxheU5hbWVdLmpvaW4oJyAgJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uZXhlY3V0ZShxdWVyeSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKG1vZGVsLnByb3RvdHlwZSkuZm9yRWFjaChmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcE9iaiA9IG1vZGVsLmJhc2Vba2V5XTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcCA9IFtwcm9wLCBrZXksIHByb3BPYmoudHlwZV0uam9pbignICcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcE9iai5hbGxvd051bGxzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wID0gW3Byb3AsICdOVUxMJ10uam9pbignICcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcCA9IFtwcm9wLCAnTk9UIE5VTEwnXS5qb2luKCcgJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wT2JqLnByaW1hcnlLZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3AgPSBbcHJvcCwgJ1BSSU1BUlkgS0VZIEFVVE9JTkNSRU1FTlQnXS5qb2luKCcgJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9wT2JqLnVuaXF1ZUtleSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcCA9IFtwcm9wLCAnVU5JUVVFJ10uam9pbignICcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGUucHVzaChwcm9wKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IFsnQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMnLCB0aGlzLmRpc3BsYXlOYW1lLCAnKCcsIGNyZWF0ZS5qb2luKCcsICcpLCAnKSddLmpvaW4oJyAgJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uZXhlY3V0ZShxdWVyeSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGluc2VydDogZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluc2VydCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKG1vZGVsLnByb3RvdHlwZSkuZm9yRWFjaChmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAhPSAnaWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydC5wdXNoKGtleSk7IC8vIHByb3BcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gob2JqZWN0W2tleV0pOyAvLyB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcgaW5zZXJ0IGludG8gezB9ICggezF9ICkgdmFsdWVzICggPyB7Mn0gKSAnLmZvcm1hdChcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbC5kaXNwbGF5TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBpbnNlcnQuam9pbignLCAnKSxcclxuICAgICAgICAgICAgICAgICAgICAnLCA/Jy5yZXBlYXQodmFsdWVzLmxlbmd0aCAtIDEpKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0uZXhlY3V0ZShxdWVyeSwgdmFsdWVzKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbihvYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVzID0gW107XHJcblxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMobW9kZWwucHJvdG90eXBlKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ICE9ICdpZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLnB1c2goa2V5ICsgJyA9ID8nKTsgLy8gcHJvcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChvYmplY3Rba2V5XSk7IC8vIHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gob2JqZWN0LmlkKTtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9ICcgdXBkYXRlIHswfSBzZXQgezF9IHdoZXJlIGlkID0gPyAnLmZvcm1hdChtb2RlbC5kaXNwbGF5TmFtZSwgdXBkYXRlLmpvaW4oJywgJykpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnksIHZhbHVlcyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlbGV0ZTogZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnIGRlbGV0ZSBmcm9tIHswfSB3aGVyZSBpZCA9ID8gJy5mb3JtYXQobW9kZWwuZGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnksIFtpZF0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnIHNlbGVjdCAqIGZyb20gezB9ICcuZm9ybWF0KFt0aGlzLmRpc3BsYXlOYW1lXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBxdWVyeSArICcgd2hlcmUgaWQgPSA/ICc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnksIFtpZF0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm0uZXhlY3V0ZShxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2bS5pbXBsZW1lbnQgPSBmdW5jdGlvbihuYW1lLCBiYXNlLCBmb3JjZSkge1xyXG4gICAgICAgICAgICAvLyBpbXBsZW1lbnRhw6fDo28gZG8gbW9kZWxvIGVtIHVtIG9iamV0by5cclxuICAgICAgICAgICAgZnVuY3Rpb24gbW9kZWwoKSB7fVxyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhiYXNlKS5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICAgICAgICAgIG1vZGVsLnByb3RvdHlwZVtwcm9wXSA9IG51bGw7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtb2RlbC5wcm90b3R5cGUuaWQgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgbW9kZWwuZGlzcGxheU5hbWUgPSBuYW1lO1xyXG4gICAgICAgICAgICBtb2RlbC5iYXNlID0gYmFzZTtcclxuXHJcbiAgICAgICAgICAgIG1vZGVsLmRyb3AgPSB2bS5vcm0uZHJvcDtcclxuICAgICAgICAgICAgbW9kZWwuY3JlYXRlID0gdm0ub3JtLmNyZWF0ZTtcclxuICAgICAgICAgICAgbW9kZWwuaW5zZXJ0ID0gdm0ub3JtLmluc2VydDtcclxuICAgICAgICAgICAgbW9kZWwudXBkYXRlID0gdm0ub3JtLnVwZGF0ZTtcclxuICAgICAgICAgICAgbW9kZWwuZGVsZXRlID0gdm0ub3JtLmRlbGV0ZTtcclxuICAgICAgICAgICAgbW9kZWwuc2VsZWN0ID0gdm0ub3JtLnNlbGVjdDtcclxuXHJcbiAgICAgICAgICAgIHZtLmRldmljZXJlYWR5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZvcmNlKVxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmRyb3AoKTtcclxuICAgICAgICAgICAgICAgIG1vZGVsLmNyZWF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtb2RlbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkZXZpY2VyZWFkeTogdm0uZGV2aWNlcmVhZHksXHJcbiAgICAgICAgICAgIGltcGxlbWVudDogdm0uaW1wbGVtZW50XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSgpKTsiXX0=
