!function(){"use strict";function e(){var e=this;return e.isDeviceReady=!1,e.connect=function(){if(t){var e={name:"database.db",location:"default",bgType:1};return $cordovaSQLite.openDB(e)}},e.execute=function(r,o){return t?$cordovaSQLite.execute(e.connect(),r,o):{then:function(){return{catch:function(){}}}}},e.deviceready=function(t){e.isDeviceReady?t():document.addEventListener("deviceready",function(){t()},!1)},console.log("Ready: "+e.isDeviceReady),e.deviceready(function(t){e.isDeviceReady=!0,console.log("Ready: "+e.isDeviceReady)}),e.orm={drop:function(){var t=["DROP TABLE IF EXISTS",this.displayName].join("  ");return e.execute(t)},create:function(){var t=this,r=[];Object.keys(t.prototype).forEach(function(e,o){var n="",i=t.base[e];n=[n,e,i.type].join(" "),n=i.allowNulls?[n,"NULL"].join(" "):[n,"NOT NULL"].join(" "),i.primaryKey?n=[n,"PRIMARY KEY AUTOINCREMENT"].join(" "):i.uniqueKey&&(n=[n,"UNIQUE"].join(" ")),r.push(n)});var o=["CREATE TABLE IF NOT EXISTS",this.displayName,"(",r.join(", "),")"].join("  ");return e.execute(o)},insert:function(t){var r=this,o=[],n=[];Object.keys(r.prototype).forEach(function(e,r){"id"!=e&&(o.push(e),n.push(t[e]))});var i=" insert into {0} ( {1} ) values ( ? {2} ) ".format(r.displayName,o.join(", "),", ?".repeat(n.length-1));return e.execute(i,n)},update:function(t){var r=this,o=[],n=[];Object.keys(r.prototype).forEach(function(e,r){"id"!=e&&(o.push(e+" = ?"),n.push(t[e]))}),n.push(t.id);var i=" update {0} set {1} where id = ? ".format(r.displayName,o.join(", "));return e.execute(i,n)},delete:function(t){var r=this,o=" delete from {0} where id = ? ".format(r.displayName);return e.execute(o,[t])},select:function(t){var r=" select * from {0} ".format([this.displayName]);return t?(r+=" where id = ? ",e.execute(r,[t])):e.execute(r)}},e.implement=function(t,r,o){function n(){}return Object.keys(r).forEach(function(e){n.prototype[e]=null}),n.prototype.id=null,n.displayName=t,n.base=r,n.drop=e.orm.drop,n.create=e.orm.create,n.insert=e.orm.insert,n.update=e.orm.update,n.delete=e.orm.delete,n.select=e.orm.select,e.deviceready(function(){o&&n.drop(),n.create()}),n},{deviceready:e.deviceready,implement:e.implement}}var t="browser"!=cordova.platformId;String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t})}),String.prototype.repeat||(String.prototype.repeat=function(e){for(var t="",r=this,o=0;o<e;o++)t+=r;return t});angular.module("Colite",["ngCordova"]).service("$colite",e).constant("Colite",{STRING:"STRING",INTEGER:"INTEGER",DATE:"DATE",DATETIME:"DATETIME",BIGINT:"BIGINT",DECIMAL:"NUMERIC",TEXT:"TEXT"});console.log(cordova.platformId),t&&(e.$inject=["$cordovaSQLite"])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbGl0ZS5qcyJdLCJuYW1lcyI6WyJDb2xpdGUiLCJ2bSIsInRoaXMiLCJpc0RldmljZVJlYWR5IiwiY29ubmVjdCIsImlzQnJvd3NlciIsImNvbmZpZyIsIm5hbWUiLCJsb2NhdGlvbiIsImJnVHlwZSIsIiRjb3Jkb3ZhU1FMaXRlIiwib3BlbkRCIiwiZXhlY3V0ZSIsInF1ZXJ5IiwidmFsdWVzIiwidGhlbiIsImNhdGNoIiwiZGV2aWNlcmVhZHkiLCJjYWxsYmFjayIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnNvbGUiLCJsb2ciLCJvcm0iLCJkcm9wIiwiZGlzcGxheU5hbWUiLCJqb2luIiwiY3JlYXRlIiwibW9kZWwiLCJPYmplY3QiLCJrZXlzIiwicHJvdG90eXBlIiwiZm9yRWFjaCIsImtleSIsInZhbHVlIiwicHJvcCIsInByb3BPYmoiLCJiYXNlIiwidHlwZSIsImFsbG93TnVsbHMiLCJwcmltYXJ5S2V5IiwidW5pcXVlS2V5IiwicHVzaCIsImluc2VydCIsIm9iamVjdCIsImZvcm1hdCIsInJlcGVhdCIsImxlbmd0aCIsInVwZGF0ZSIsImlkIiwiZGVsZXRlIiwic2VsZWN0IiwiaW1wbGVtZW50IiwiZm9yY2UiLCJjb3Jkb3ZhIiwicGxhdGZvcm1JZCIsIlN0cmluZyIsImFyZ3MiLCJhcmd1bWVudHMiLCJyZXBsYWNlIiwibWF0Y2giLCJudW1iZXIiLCJzdHIiLCJpIiwiYW5ndWxhciIsIm1vZHVsZSIsInNlcnZpY2UiLCJjb25zdGFudCIsIlNUUklORyIsIklOVEVHRVIiLCJEQVRFIiwiREFURVRJTUUiLCJCSUdJTlQiLCJERUNJTUFMIiwiVEVYVCIsIiRpbmplY3QiXSwibWFwcGluZ3MiOiJDQUFDLFdBQ0csWUErQ0EsU0FBU0EsS0FDTCxHQUFJQyxHQUFLQyxJQTJKVCxPQXpKQUQsR0FBR0UsZUFBZ0IsRUFFbkJGLEVBQUdHLFFBQVUsV0FDVCxHQUFJQyxFQUFXLENBQ1gsR0FBSUMsSUFBV0MsS0FBTSxjQUFlQyxTQUFV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clxuICAgICd1c2Ugc3RyaWN0J1xyXG5cclxuICAgIHZhciBpc0Jyb3dzZXIgPSAoY29yZG92YS5wbGF0Zm9ybUlkICE9ICdicm93c2VyJyk7XHJcblxyXG4gICAgaWYgKCFTdHJpbmcucHJvdG90eXBlLmZvcm1hdCkge1xyXG4gICAgICAgIFN0cmluZy5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC97KFxcZCspfS9nLCBmdW5jdGlvbihtYXRjaCwgbnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3NbbnVtYmVyXSAhPSAndW5kZWZpbmVkJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tudW1iZXJdIDpcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGlmICghU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQpIHtcclxuICAgICAgICBTdHJpbmcucHJvdG90eXBlLnJlcGVhdCA9IGZ1bmN0aW9uKGxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgc3RyID0gJyc7XHJcbiAgICAgICAgICAgIHZhciByZXBlYXQgPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3RyID0gc3RyICsgcmVwZWF0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNvbGl0ZSA9IGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdDb2xpdGUnLCBbJ25nQ29yZG92YSddKVxyXG4gICAgICAgIC8vIHNlcnZpw6dvcyBcclxuICAgICAgICAuc2VydmljZSgnJGNvbGl0ZScsIENvbGl0ZSlcclxuICAgICAgICAvLyBjb25zdGFudGVzIFxyXG4gICAgICAgIC5jb25zdGFudCgnQ29saXRlJywge1xyXG4gICAgICAgICAgICBTVFJJTkc6IFwiU1RSSU5HXCIsXHJcbiAgICAgICAgICAgIElOVEVHRVI6IFwiSU5URUdFUlwiLFxyXG4gICAgICAgICAgICBEQVRFOiBcIkRBVEVcIixcclxuICAgICAgICAgICAgREFURVRJTUU6IFwiREFURVRJTUVcIixcclxuICAgICAgICAgICAgQklHSU5UOiBcIkJJR0lOVFwiLFxyXG4gICAgICAgICAgICBERUNJTUFMOiBcIk5VTUVSSUNcIixcclxuICAgICAgICAgICAgVEVYVDogXCJURVhUXCJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhjb3Jkb3ZhLnBsYXRmb3JtSWQpO1xyXG4gICAgaWYgKGlzQnJvd3Nlcikge1xyXG4gICAgICAgIENvbGl0ZS4kaW5qZWN0ID0gWyckY29yZG92YVNRTGl0ZSddO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIENvbGl0ZSgpIHtcclxuICAgICAgICB2YXIgdm0gPSB0aGlzO1xyXG5cclxuICAgICAgICB2bS5pc0RldmljZVJlYWR5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHZtLmNvbm5lY3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGlzQnJvd3Nlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHsgbmFtZTogJ2RhdGFiYXNlLmRiJywgbG9jYXRpb246ICdkZWZhdWx0JywgYmdUeXBlOiAxIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGNvcmRvdmFTUUxpdGUub3BlbkRCKGNvbmZpZyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2bS5leGVjdXRlID0gZnVuY3Rpb24ocXVlcnksIHZhbHVlcykge1xyXG4gICAgICAgICAgICBpZiAoaXNCcm93c2VyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJGNvcmRvdmFTUUxpdGUuZXhlY3V0ZSh2bS5jb25uZWN0KCksIHF1ZXJ5LCB2YWx1ZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGVuOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoOiBmdW5jdGlvbigpIHt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2bS5kZXZpY2VyZWFkeSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIC8vIGNhc28gZGlzcG9zaXRpdm8gasOhIGVzdGVqYSBwcm9udG8gbsOjbyBhZGljaW9uYSBFdmVudExpc3RlbmVyLCBhcGVuYXMgZXhlY3V0YS5cclxuICAgICAgICAgICAgaWYgKHZtLmlzRGV2aWNlUmVhZHkpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdkZXZpY2VyZWFkeScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWFkeTogJyArIHZtLmlzRGV2aWNlUmVhZHkpO1xyXG4gICAgICAgIHZtLmRldmljZXJlYWR5KGZ1bmN0aW9uKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHZtLmlzRGV2aWNlUmVhZHkgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVhZHk6ICcgKyB2bS5pc0RldmljZVJlYWR5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdm0ub3JtID0ge1xyXG4gICAgICAgICAgICBkcm9wOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IFsnRFJPUCBUQUJMRSBJRiBFWElTVFMnLCB0aGlzLmRpc3BsYXlOYW1lXS5qb2luKCcgICcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnkpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHZhciBjcmVhdGUgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhtb2RlbC5wcm90b3R5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BPYmogPSBtb2RlbC5iYXNlW2tleV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHByb3AgPSBbcHJvcCwga2V5LCBwcm9wT2JqLnR5cGVdLmpvaW4oJyAnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb3BPYmouYWxsb3dOdWxscylcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcCA9IFtwcm9wLCAnTlVMTCddLmpvaW4oJyAnKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3AgPSBbcHJvcCwgJ05PVCBOVUxMJ10uam9pbignICcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcE9iai5wcmltYXJ5S2V5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wID0gW3Byb3AsICdQUklNQVJZIEtFWSBBVVRPSU5DUkVNRU5UJ10uam9pbignICcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvcE9iai51bmlxdWVLZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3AgPSBbcHJvcCwgJ1VOSVFVRSddLmpvaW4oJyAnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlLnB1c2gocHJvcCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBbJ0NSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTJywgdGhpcy5kaXNwbGF5TmFtZSwgJygnLCBjcmVhdGUuam9pbignLCAnKSwgJyknXS5qb2luKCcgICcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnkpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBpbnNlcnQ6IGZ1bmN0aW9uKG9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHZhciBpbnNlcnQgPSBbXTtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhtb2RlbC5wcm90b3R5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgIT0gJ2lkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnQucHVzaChrZXkpOyAvLyBwcm9wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKG9iamVjdFtrZXldKTsgLy8gdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnIGluc2VydCBpbnRvIHswfSAoIHsxfSApIHZhbHVlcyAoID8gezJ9ICkgJy5mb3JtYXQoXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0LmpvaW4oJywgJyksXHJcbiAgICAgICAgICAgICAgICAgICAgJywgPycucmVwZWF0KHZhbHVlcy5sZW5ndGggLSAxKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnksIHZhbHVlcyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24ob2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVwZGF0ZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKG1vZGVsLnByb3RvdHlwZSkuZm9yRWFjaChmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAhPSAnaWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS5wdXNoKGtleSArICcgPSA/Jyk7IC8vIHByb3BcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gob2JqZWN0W2tleV0pOyAvLyB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKG9iamVjdC5pZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSAnIHVwZGF0ZSB7MH0gc2V0IHsxfSB3aGVyZSBpZCA9ID8gJy5mb3JtYXQobW9kZWwuZGlzcGxheU5hbWUsIHVwZGF0ZS5qb2luKCcsICcpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2bS5leGVjdXRlKHF1ZXJ5LCB2YWx1ZXMpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWxldGU6IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJyBkZWxldGUgZnJvbSB7MH0gd2hlcmUgaWQgPSA/ICcuZm9ybWF0KG1vZGVsLmRpc3BsYXlOYW1lKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2bS5leGVjdXRlKHF1ZXJ5LCBbaWRdKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJyBzZWxlY3QgKiBmcm9tIHswfSAnLmZvcm1hdChbdGhpcy5kaXNwbGF5TmFtZV0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkgKyAnIHdoZXJlIGlkID0gPyAnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2bS5leGVjdXRlKHF1ZXJ5LCBbaWRdKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZtLmV4ZWN1dGUocXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdm0uaW1wbGVtZW50ID0gZnVuY3Rpb24obmFtZSwgYmFzZSwgZm9yY2UpIHtcclxuICAgICAgICAgICAgLy8gaW1wbGVtZW50YcOnw6NvIGRvIG1vZGVsbyBlbSB1bSBvYmpldG8uXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG1vZGVsKCkge31cclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoYmFzZSkuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgICAgICAgICBtb2RlbC5wcm90b3R5cGVbcHJvcF0gPSBudWxsO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbW9kZWwucHJvdG90eXBlLmlkID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIG1vZGVsLmRpc3BsYXlOYW1lID0gbmFtZTtcclxuICAgICAgICAgICAgbW9kZWwuYmFzZSA9IGJhc2U7XHJcblxyXG4gICAgICAgICAgICBtb2RlbC5kcm9wID0gdm0ub3JtLmRyb3A7XHJcbiAgICAgICAgICAgIG1vZGVsLmNyZWF0ZSA9IHZtLm9ybS5jcmVhdGU7XHJcbiAgICAgICAgICAgIG1vZGVsLmluc2VydCA9IHZtLm9ybS5pbnNlcnQ7XHJcbiAgICAgICAgICAgIG1vZGVsLnVwZGF0ZSA9IHZtLm9ybS51cGRhdGU7XHJcbiAgICAgICAgICAgIG1vZGVsLmRlbGV0ZSA9IHZtLm9ybS5kZWxldGU7XHJcbiAgICAgICAgICAgIG1vZGVsLnNlbGVjdCA9IHZtLm9ybS5zZWxlY3Q7XHJcblxyXG4gICAgICAgICAgICB2bS5kZXZpY2VyZWFkeShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmb3JjZSlcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbC5kcm9wKCk7XHJcbiAgICAgICAgICAgICAgICBtb2RlbC5jcmVhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbW9kZWw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZGV2aWNlcmVhZHk6IHZtLmRldmljZXJlYWR5LFxyXG4gICAgICAgICAgICBpbXBsZW1lbnQ6IHZtLmltcGxlbWVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0oKSk7Il19
